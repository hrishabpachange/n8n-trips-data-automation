{
  "name": "Trips Data Automation",
  "nodes": [
    {
      "parameters": {
        "formTitle": "Trip details",
        "formDescription": "Enter the recent trip details",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Booked by",
              "requiredField": true
            },
            {
              "fieldLabel": "User Names",
              "requiredField": true
            },
            {
              "fieldLabel": "Cab no. ",
              "requiredField": true
            },
            {
              "fieldLabel": "Car type",
              "requiredField": true
            },
            {
              "fieldLabel": "Chauffer's Name"
            },
            {
              "fieldLabel": "Starting Time",
              "requiredField": true
            },
            {
              "fieldLabel": "Closing Time",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -32,
        -16
      ],
      "id": "af196d08-b584-4131-9570-3601eea45498",
      "name": "On form submission",
      "webhookId": "6aba5cdb-49f9-4896-b745-972cbc998ba9"
    },
    {
      "parameters": {
        "jsCode": "// Get form data\nconst form = items[0].json;\n\n// CSV header\nlet header = \"Trip Name,User Name,Cab No,Car Type,Chauffeur Name,Starting Time,Closing Time,Submitted At\";\n\n// CSV row based on your form fields\nlet row = `\\n\"${form['Booked by']}\",\"${form['User Names']}\",\"${form['Cab no.']}\",\"${form['Car type']}\",\"${form['Chauffeurâ€™s Name']}\",\"${form['Starting Time']}\",\"${form['Closing Time']}\",\"${form['submittedAt']}\"`;\n\n// Convert to CSV text\nconst csvContent = header + row;\n\n// Convert to binary for Google Drive\nconst binaryData = Buffer.from(csvContent, \"utf8\");\n\n// Output binary\nreturn [\n  {\n    json: {},   // no JSON needed\n    binary: {\n      data: {\n        data: binaryData.toString(\"base64\"),\n        mimeType: \"text/csv\",\n        fileExtension: \"csv\"\n      }\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        192,
        -112
      ],
      "id": "3ebc7b65-2e94-49e1-bd8b-3adc14914c44",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d8a39a22-0637-4327-a038-d7d3d0b34031",
              "name": "html",
              "value": "=<html>\n  <body>\n    <h1>PDF Test</h1>\n    <p>This PDF was generated by n8n.</p>\n  </body>\n</html>\n",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        192,
        80
      ],
      "id": "221c41b5-0e1d-4f2e-b378-48c8b52260a2",
      "name": "Edit Fields"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-htmlcsstoimage.htmlCssToImage",
      "typeVersion": 1,
      "position": [
        416,
        80
      ],
      "id": "35db130e-1085-473d-a101-1a91e31d23ad",
      "name": "HTML/CSS to Image",
      "credentials": {
        "htmlcsstoimgApi": {
          "id": "KQGYaJ1DdCyQiV0S",
          "name": "Htmlcsstoimg account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "hrishabpachange02@gmail.com",
        "toEmail": "hrishabpachange02@gmail.com",
        "subject": "Duty Slip",
        "html": "=<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <style>\n    body {\n      font-family: Arial, Helvetica, sans-serif;\n      padding: 20px;\n      background: white;\n    }\n\n    .slip-container {\n      width: 700px;\n      border: 2px solid #3a7d4f;\n      padding: 20px;\n    }\n\n    h2 {\n      text-align: center;\n      color: #3a7d4f;\n      margin-bottom: 10px;\n    }\n\n    table {\n      width: 100%;\n      border-collapse: collapse;\n      margin-bottom: 15px;\n    }\n\n    td {\n      padding: 8px;\n      border: 1px solid #999;\n      font-size: 14px;\n    }\n\n    .section-title {\n      font-weight: bold;\n      background: #e9f5ec;\n    }\n\n    .logo {\n      text-align: right;\n      margin-bottom: 10px;\n    }\n\n    .footer {\n      margin-top: 20px;\n      font-size: 12px;\n      text-align: center;\n    }\n  </style>\n</head>\n<body>\n\n<div class=\"slip-container\">\n\n  <h2>Duty Slip</h2>\n\n  <!-- COMPANY LOGO -->\n  <div class=\"logo\">\n    <img src=\"https://i.ibb.co/txQK0qj/logo.png\" width=\"150\">\n  </div>\n\n  <table>\n    <tr>\n      <td class=\"section-title\">Booked By:</td>\n      <td>{{$json[\"Booked by\"]}}</td>\n    </tr>\n    <tr>\n      <td class=\"section-title\">User Names:</td>\n      <td>{{$json[\"User Names\"]}}</td>\n    </tr>\n    <tr>\n      <td class=\"section-title\">Reporting Address:</td>\n      <td>{{$json[\"Booked By\"]}}</td>\n    </tr>\n  </table>\n\n  <table>\n    <tr>\n      <td class=\"section-title\">Cab No.:</td>\n      <td>{{$json[\"Cab no.\"]}}</td>\n      <td class=\"section-title\">Car Type:</td>\n      <td>{{$json[\"Car type\"]}}</td>\n    </tr>\n\n    <tr>\n      <td class=\"section-title\">Chauffeur Name:</td>\n      <td>{{$json[\"Chauffer's Name\"]}}</td>\n      <td class=\"section-title\">Trip:</td>\n      <td>{{$json[\"formMode\"]}}</td>\n    </tr>\n  </table>\n\n  <table>\n    <tr>\n      <td class=\"section-title\">Reporting Time:</td>\n      <td>{{$json[\"Starting Time\"]}}</td>\n      <td class=\"section-title\">Closing Time:</td>\n      <td>{{$json[\"Closing Time\"]}}</td>\n    </tr>\n\n    <tr>\n      <td class=\"section-title\">Starting Kms:</td>\n      <td>{{$json[\"Starting Kms\"]}}</td>\n      <td class=\"section-title\">Closing Kms:</td>\n      <td>{{$json[\"Closing Kms\"]}}</td>\n    </tr>\n  </table>\n\n  <table>\n    <tr>\n      <td class=\"section-title\">Total Kms:</td>\n      <td>{{$json[\"Total Kms\"]}}</td>\n      <td class=\"section-title\">Total Hours:</td>\n      <td>{{$json[\"Total Hours\"]}}</td>\n    </tr>\n  </table>\n\n  <div class=\"footer\">\n    <p><strong>Declaration:</strong><br>\n    Company is not responsible for luggage or valuables left in the cab.  \n    Any dispute will be under Pune jurisdiction.</p>\n  </div>\n\n</div>\n\n</body>\n</html>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        640,
        80
      ],
      "id": "5df483d0-48b9-412f-af63-acfdb58ef4d9",
      "name": "Send email",
      "webhookId": "75ea730e-161c-47b3-907f-beaccdf208b8",
      "credentials": {
        "smtp": {
          "id": "s33g0DkwoCjNnc40",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "name": "trips.csv",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1c8-hgYdmnki5BUc1QuNCMfeQfZ4dZBSn",
          "mode": "list",
          "cachedResultName": "n8n Trip Data",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1c8-hgYdmnki5BUc1QuNCMfeQfZ4dZBSn"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        416,
        -112
      ],
      "id": "3db791bd-f9e3-4487-8680-1d16ea715918",
      "name": "Upload file",
      "alwaysOutputData": false,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PHV5erCmAdlO4osB",
          "name": "Google Drive account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1OTJ6-UZCxN-COQg_wa2i6t6Im-m6FX",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        640,
        -112
      ],
      "id": "2b419e4c-87f1-4398-ac41-3fe35491115c",
      "name": "Download file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "PHV5erCmAdlO4osB",
          "name": "Google Drive account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "On form submission": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "HTML/CSS to Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML/CSS to Image": {
      "main": [
        [
          {
            "node": "Send email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "047683d4-5ae1-4e4e-b639-265001a9c7b9",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "de0cf58ac5e34776892adde2afa26804eeef8fc3d255458daf145e6c50065ea6"
  },
  "id": "ypH1YVe1foNQdIu7",
  "tags": []
}

"_meta": {
  "author": "Hrishab Pachange",
  "license": "Proprietary",
  "created": "2026",
  "notice": "Unauthorized use prohibited"
}
